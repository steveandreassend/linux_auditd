-a always,exit -F path=/usr/bin/chacl -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged

## STIG
## V-230419 Successful/unsuccessful uses of the chcon command in RHEL 8 must generate an audit record.
## Without generating audit records that are specific to the security and mission needs of the organization,
## it would be difficult to establish, correlate, and investigate the events relating to an incident or identify
## those responsible for one. Audit records can be generated from various components within the information system
## (e.g., module or policy filter). The "chcon" command is used to change file SELinux security context. When a
## user logs on, the AUID is set to the UID of the account that is being authenticated. Daemons are not user
## sessions and have the loginuid set to "-1". The AUID representation is an unsigned 32-bit integer, which 
## equals "4294967295". The audit system interprets "-1", "4294967295", and "unset" in the same way.
## Satisfies: SRG-OS-000062-GPOS-00031, SRG-OS-000037-GPOS-00015, SRG-OS-000042-GPOS-00020, SRG-OS-000062-GPOS-00031,
## SRG-OS-000392-GPOS-00172, SRG-OS-000462-GPOS-00206, SRG-OS-000468-GPOS-00212, SRG-OS-000471-GPOS-00215
-a always,exit -F path=/usr/bin/chcon -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged
##-a always,exit -F path=/usr/bin/chcon -F perm=x -F auid>=1000 -F auid!=unset -k perm_mod

-a always,exit -F path=/usr/sbin/semanage -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged
-a always,exit -F path=/usr/bin/setfacl -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged
-a always,exit -F path=/usr/sbin/setfiles -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged
-a always,exit -F path=/usr/sbin/setsebool -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged

## STIG
## V-230418 Successful/unsuccessful uses of the chage command in RHEL 8 must generate an audit record.
## Without generating audit records that are specific to the security and mission needs of the organization,
## it would be difficult to establish, correlate, and investigate the events relating to an incident or identify
## those responsible for one. Audit records can be generated from various components within the information system
## (e.g., module or policy filter). The "chage" command is used to change or view user password expiry information.
## When a user logs on, the AUID is set to the UID of the account that is being authenticated. Daemons are not user
## sessions and have the loginuid set to "-1". The AUID representation is an unsigned 32-bit integer, which equals
## "4294967295". The audit system interprets "-1", "4294967295", and "unset" in the same way.
## Satisfies: SRG-OS-000062-GPOS-00031, SRG-OS-000037-GPOS-00015, SRG-OS-000042-GPOS-00020, SRG-OS-000062-GPOS-00031,
## SRG-OS-000392-GPOS-00172, SRG-OS-000462-GPOS-00206, SRG-OS-000468-GPOS-00212, SRG-OS-000471-GPOS-00215
-a always,exit -F path=/usr/bin/chage -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged

-a always,exit -F path=/usr/bin/chsh -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged
-a always,exit -F path=/usr/bin/crontab -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged
-a always,exit -F path=/usr/bin/gpasswd -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged
-a always,exit -F path=/usr/bin/mount -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged
-a always,exit -F path=/usr/bin/newgrp -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged
-a always,exit -F path=/usr/sbin/pam_timestamp_check -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged
-a always,exit -F path=/usr/bin/passwd -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged
-a always,exit -F path=/usr/sbin/postdrop -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged
-a always,exit -F path=/usr/sbin/postqueue -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged
-a always,exit -F path=/usr/bin/ssh-agent -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged
-a always,exit -F path=/usr/libexec/openssh/ssh-keysign -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged

## STIG
## V-230412 Successful/unsuccessful uses of the su command in RHEL 8 must generate an audit record.
## Without generating audit records that are specific to the security and mission needs of the organization,
## it would be difficult to establish, correlate, and investigate the events relating to an incident or
## identify those responsible for one. Audit records can be generated from various components within the
## information system (e.g., module or policy filter). The "su" command allows a user to run commands with
## a substitute user and group ID. When a user logs on, the AUID is set to the UID of the account that is
## being authenticated. Daemons are not user sessions and have the loginuid set to "-1". The AUID representation
## is an unsigned 32-bit integer, which equals "4294967295". The audit system interprets "-1", "4294967295", and
## "unset" in the same way.
## Satisfies: SRG-OS-000062-GPOS-00031, SRG-OS-000037-GPOS-00015, SRG-OS-000042-GPOS-00020, SRG-OS-000062-GPOS-00031,
## SRG-OS-000064-GPOS-0003, SRG-OS-000392-GPOS-00172, SRG-OS-000462-GPOS-00206, SRG-OS-000471-GPOS-00215, SRG-OS-000466-GPOS-00210
-a always,exit -F path=/usr/bin/su -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged
##-a always,exit -F path=/usr/bin/su -F perm=x -F auid>=1000 -F auid!=unset -k privileged-priv_change

## V-230462 Successful/unsuccessful uses of the sudo command in RHEL 8 must generate an audit record.
## Without generating audit records that are specific to the security and mission needs of the organization,
## it would be difficult to establish, correlate, and investigate the events relating to an incident or identify
## those responsible for one. Audit records can be generated from various components within the information system
## (e.g., module or policy filter). The "sudo" command allows a permitted user to execute a command as the superuser
## or another user, as specified by the security policy. When a user logs on, the AUID is set to the UID of the account
## that is being authenticated. Daemons are not user sessions and have the loginuid set to "-1". The AUID representation
## is an unsigned 32-bit integer, which equals "4294967295". The audit system interprets "-1", "4294967295", and "unset"
## in the same way.
## Satisfies: SRG-OS-000062-GPOS-00031, SRG-OS-000037-GPOS-00015, SRG-OS-000042-GPOS-00020, SRG-OS-000062-GPOS-00031,
## SRG-OS-000392-GPOS-00172, SRG-OS-000462-GPOS-00206, SRG-OS-000471-GPOS-00215, SRG-OS-000466-GPOS-00210
-a always,exit -F path=/usr/bin/sudo -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged
##-a always,exit -F path=/usr/bin/sudo -F perm=x -F auid>=1000 -F auid!=unset -k priv_cmd


-a always,exit -F path=/usr/bin/umount -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged
-a always,exit -F path=/usr/sbin/unix_chkpwd -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged
-a always,exit -F path=/usr/sbin/unix_update -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged
-a always,exit -F path=/usr/sbin/userhelper -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged
-a always,exit -F path=/usr/sbin/usermod -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged
-a always,exit -F path=/usr/bin/kmod -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged
